import{m as s}from"./matter.pt6j9RHZ.js";import{T as g}from"./tempus.B_tY_6We.js";import{g as p}from"./index.ODjX2MmM.js";import{S as d}from"./SplitText.CE9jb_0x.js";import{S as h}from"./ScrollTrigger.Dc0K9LmA.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./strings.CrAViUxe.js";p.registerPlugin(d,h);class b{constructor(t,r){this.app=r,this.main=t,this.scroll=this.app.scroll.lenis,this.wrapper=this.main.querySelector(".hero"),this.fallingWrapper=this.wrapper.querySelector(".falling-text"),this.text=this.fallingWrapper.querySelector("p"),this.numItems=this.wrapper.querySelectorAll(".num_item"),this.rootStyles=getComputedStyle(document.documentElement),this.red=this.rootStyles.getPropertyValue("--red").trim(),this.white=this.rootStyles.getPropertyValue("--white").trim(),this.velocity=0,this.allowMoveAway=!1,this.destroyed=!1,this.addSplit(),this.addScroll(),this.initWord(),this.init(),this.tick=g.add(this.update.bind(this)),this.app.on("destroy",()=>{this.destroyed=!0,this.allowRender=!1,this.tick()}),this.app.on("resize",()=>this.resize()),h.create({trigger:this.wrapper,start:"top top",end:"bottom bottom",onEnter:()=>this.wrapper.classList.add("visible"),onLeaveBack:()=>this.wrapper.classList.remove("visible"),onLeave:()=>this.wrapper.classList.remove("visible"),onEnterBack:()=>this.wrapper.classList.add("visible")})}addSplit(){this.split=new d(this.text,{type:"words",wordsClass:"text-words",position:"absolute"}),this.revealTl=p.timeline({paused:!0}),this.split.words.forEach(t=>{t.parentElement.tagName==="SPAN"?t.style.setProperty("--width",t.offsetWidth):this.revealTl.fromTo(t,{autoAlpha:1},{autoAlpha:0,duration:.5,immediateRender:!1},0)}),this.spans=this.wrapper.querySelectorAll("span"),this.spanSplit=new d(this.spans,{type:"chars",charsClass:"text-char",position:"relative"}),this.splitToBodies=[],this.spanSplit.chars.forEach((t,r)=>{const i=t.parentElement,e=Array.from(this.split.words).indexOf(i);this.app.sizes.width>1024?this.splitToBodies.push(t):e!==-1&&e<147&&this.splitToBodies.push(t)})}addScroll(){this.isDesktop=this.app.sizes.width>1024,this.appearTl=p.timeline({paused:!0}),this.appearTl.fromTo(this.split.words,{opacity:0},{opacity:1,stagger:{amount:.5,from:"random"}}).to(this.numItems,{"--opacity":0,stagger:{amount:.2,from:"random"}},"<"),this.startScroll=h.create({trigger:this.wrapper,start:`top top-=${this.isDesktop?200:150}%`,end:`top top-=${this.isDesktop?300:240}%`,scrub:!0,animation:this.appearTl,onEnterBack:()=>this.revealTl.pause()}),this.changeColorTl=p.timeline({paused:!0}),this.changeColorTl.fromTo(this.spans,{color:this.red},{color:this.white,stagger:.01}),this.colorScroll=h.create({trigger:this.wrapper,start:`top top-=${this.isDesktop?300:240}%`,end:`top top-=${this.isDesktop?350:280}%`,scrub:!0,animation:this.changeColorTl}),this.fallingScroll=h.create({trigger:this.wrapper,start:`top top-=${this.isDesktop?375:300}%`,onEnter:()=>this.enterFalling(),onLeaveBack:()=>this.backFalling(),onEnterBack:()=>this.revealTl.pause()}),this.removingScroll=h.create({trigger:this.wrapper,start:`top top-=${this.isDesktop?450:330}%`,end:`top top-=${this.isDesktop?500:350}%`,onEnter:()=>{this.velocity=0,this.allowMoveAway=!0},onLeaveBack:()=>this.allowMoveAway=!1,onEnterBack:()=>{this.allowMoveAway=!1,this.allowRender=!0,this.fallingWrapper.classList.remove("disabble")}})}moveAway(){this.checksX=[],this.checkBoddy=[],this.scroll.on("scroll",t=>{if(!this.allowMoveAway)return;const r=Math.abs(t.velocity*1e-5)*-1;this.velocity+=r,this.boddies.forEach(i=>{s.Body.applyForce(i.box,{x:i.box.position.x,y:i.box.position.y},{x:this.velocity,y:0});const e=window.getComputedStyle(i.char);Math.abs(e.getPropertyValue("--x"))>0&&this.checkBoddy.push(i.char.getBoundingClientRect().left)}),this.checkBoddy.forEach(i=>{i<-100&&this.checksX.push(i)}),this.checkBoddy.length===this.checksX.length&&(this.boddies.forEach((i,e)=>{const o=this.splitToBodies[e],a=o.getBoundingClientRect().left,l=o.getBoundingClientRect().top,n=a+window.innerWidth,c=l+window.innerHeight;o.style.setProperty("--x",n),o.style.setProperty("--y",c),s.Body.setPosition(i.box,{x:n,y:c})}),this.allowRender=!1,this.allowMoveAway=!1,this.fallingWrapper.classList.add("disabble")),this.checksX=[],this.checkBoddy=[]})}initWord(){this.engine=s.Engine.create(),this.world=this.engine.world,this.allowRender=!1,this.ground=s.Bodies.rectangle(window.innerWidth/2,window.innerWidth>479?window.innerHeight:window.outerHeight,window.innerWidth,10,{isStatic:!0,render:{fillStyle:"brown"}}),s.World.add(this.world,this.ground)}init(){this.boddies=[],this.splitToBodies.forEach((t,r)=>{const i=Math.random(),e=t.getBoundingClientRect(),o=e.left+e.width/2,a=e.top+e.height/2,l=s.Bodies.rectangle(o,a,e.width,e.height,{isStatic:!1,render:{fillStyle:"white"}});s.World.add(this.world,l),l.restitution=i*1.2+.1,this.boddies.push({box:l,top:e.top,left:e.left,initX:o,initY:a,char:t})}),this.world.gravity.y=1,this.moveAway()}enterFalling(){this.allowRender=!0,this.fallingWrapper.classList.add("falling"),this.revealTl.restart(),this.boddies.forEach(t=>{const r=(Math.random()-.5)*.03;s.Body.applyForce(t.box,{x:t.box.position.x,y:t.box.position.y},{x:0,y:r})})}backFalling(){this.allowRender=!1,this.fallingWrapper.classList.remove("falling"),this.revealTl.reverse(),this.boddies.forEach(t=>{s.Body.setPosition(t.box,{x:t.initX,y:t.initY}),s.Body.setAngle(t.box,0),s.Body.setVelocity(t.box,{x:0,y:0}),s.Body.setAngularVelocity(t.box,0),t.box.force.x=0,t.box.force.y=0,t.box.torque=0})}update(){this.allowRender&&(s.Engine.update(this.engine,1e3/60),this.boddies.forEach((t,r)=>{const i=t.box.position,e=t.box.angle,o=this.splitToBodies[r],a=i.x-o.offsetWidth/2-t.left,l=i.y-o.offsetHeight/2-t.top,n=e;o.style.setProperty("--x",a),o.style.setProperty("--y",l),o.style.setProperty("--rotate",n)}))}resize(){this.destroyed||(this.wrapper.classList.contains("visible")?this.scroll.scrollTo(this.wrapper,{offset:0,duration:.1,onComplete:()=>this.destroyInit()}):this.destroyInit())}destroyInit(){this.boddies.forEach(t=>{s.World.remove(this.world,t.box)}),s.World.remove(this.world,this.ground),this.ground=s.Bodies.rectangle(window.innerWidth/2,window.innerWidth>479?window.innerHeight:window.outerHeight,window.innerWidth,10,{isStatic:!0,render:{fillStyle:"brown"}}),s.World.add(this.world,this.ground),this.appearTl.kill(),this.changeColorTl.kill(),this.fallingScroll.kill(),this.startScroll.kill(),this.colorScroll.kill(),this.split.revert(),this.spanSplit.revert(),this.addSplit(),this.addScroll(),this.init()}async settings(){this.guiMod=this.app.debug,await this.guiMod.loadGui(),this.gui=this.app.debug.gui}}export{b as default};
